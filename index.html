<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Hegemony: Maximum Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Roboto+Mono:wght@300;400;700&display=swap');

        :root {
            --neon-blue: #00f2ff;
            --neon-green: #39ff14;
            --neon-red: #ff0044;
            --neon-gold: #ffcc00;
            --bg-dark: #05060a;
            --panel-bg: rgba(13, 17, 28, 0.95);
        }

        body {
            background: var(--bg-dark);
            color: #e0e0e0;
            font-family: 'Roboto Mono', monospace;
            overflow: hidden;
            user-select: none;
        }

        .orbitron { font-family: 'Orbitron', sans-serif; }

        .glass {
            background: var(--panel-bg);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(0, 242, 255, 0.15);
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
        }

        .btn-cyber {
            position: relative;
            background: linear-gradient(135deg, #0044ff, #00f2ff);
            color: black;
            font-weight: 900;
            text-transform: uppercase;
            clip-path: polygon(10% 0, 100% 0, 90% 100%, 0 100%);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            overflow: hidden;
        }

        .btn-cyber::after {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: 0.5s;
        }

        .btn-cyber:hover::after { left: 100%; }
        .btn-cyber:hover {
            transform: scale(1.05) skewX(-5deg);
            box-shadow: 0 0 15px var(--neon-blue);
        }

        .cyber-border {
            border-left: 4px solid var(--neon-blue);
            background: linear-gradient(90deg, rgba(0, 242, 255, 0.1), transparent);
        }

        .scroll-custom::-webkit-scrollbar { width: 4px; }
        .scroll-custom::-webkit-scrollbar-track { background: #050505; }
        .scroll-custom::-webkit-scrollbar-thumb { background: var(--neon-blue); border-radius: 10px; }

        .stat-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.05);
            transition: 0.3s;
        }
        .stat-card:hover { border-color: var(--neon-blue); background: rgba(0, 242, 255, 0.05); }

        .tab-active {
            color: var(--neon-blue);
            border-bottom: 2px solid var(--neon-blue);
            text-shadow: 0 0 10px var(--neon-blue);
        }

        @keyframes scanline {
            0% { top: -100%; }
            100% { top: 100%; }
        }
        .scanline {
            position: absolute;
            width: 100%;
            height: 5px;
            background: rgba(0, 242, 255, 0.05);
            animation: scanline 8s linear infinite;
            pointer-events: none;
        }

        .modal-overlay {
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(5px);
        }

        .tech-node {
            border: 1px solid rgba(255,255,255,0.1);
            background: rgba(10,10,20,0.8);
            transition: 0.3s;
            cursor: pointer;
        }
        .tech-node.unlocked { border-color: var(--neon-green); color: var(--neon-green); }
        .tech-node.available { border-color: var(--neon-blue); }
        .tech-node:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.5); }

        /* –ú–∞—Ä–∫–µ—Ä—ã –Ω–∞ –∫–∞—Ä—Ç–µ */
        .map-marker {
            position: absolute;
            width: 8px;
            height: 8px;
            background: var(--neon-blue);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--neon-blue);
            cursor: pointer;
            transition: 0.3s;
        }
        .map-marker:hover { transform: scale(2); z-index: 10; }
        .map-marker::after {
            content: '';
            position: absolute;
            inset: -4px;
            border: 1px solid var(--neon-blue);
            border-radius: 50%;
            animation: ping 2s infinite;
        }
        @keyframes ping {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(3); opacity: 0; }
        }
    </style>
</head>
<body class="h-screen w-screen flex flex-col overflow-hidden">

    <div class="scanline"></div>

    <!-- STARTUP SCREEN -->
    <div id="setup-screen" class="fixed inset-0 z-[1000] bg-[#020305] flex items-center justify-center p-6">
        <div class="max-w-7xl w-full grid grid-cols-1 lg:grid-cols-12 gap-6 h-[90vh]">
            
            <!-- REGESTRY -->
            <div class="lg:col-span-3 glass p-6 rounded-2xl flex flex-col overflow-hidden">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="orbitron text-cyan-400 text-lg uppercase tracking-widest">Global Registry</h2>
                    <span class="text-[10px] bg-cyan-900/50 px-2 py-1 rounded text-cyan-300">v4.0.2</span>
                </div>
                <div class="relative mb-4">
                    <input type="text" id="search-input" placeholder="SEARCH NATION..." class="w-full bg-black/60 border border-cyan-500/20 p-3 pl-10 rounded-xl text-xs outline-none focus:border-cyan-400 transition">
                    <span class="absolute left-3 top-3 opacity-30">üîç</span>
                </div>
                <div id="country-list" class="flex-grow overflow-y-auto scroll-custom space-y-2 pr-2">
                    <!-- Loaded via JS -->
                </div>
            </div>

            <!-- CREATOR -->
            <div class="lg:col-span-9 glass p-10 rounded-2xl flex flex-col relative overflow-hidden">
                <!-- Background decoration -->
                <div class="absolute top-[-10%] right-[-10%] w-96 h-96 bg-cyan-500/5 rounded-full blur-[100px]"></div>
                
                <header class="mb-10 flex justify-between items-start">
                    <div>
                        <h1 class="orbitron text-5xl font-black text-white italic tracking-tighter">GLOBAL <span class="text-cyan-400">HEGEMONY</span></h1>
                        <p class="text-cyan-500/60 text-xs mt-2 uppercase tracking-[0.4em]">Integrated Geopolitical Simulation Environment</p>
                    </div>
                    <div class="text-right">
                        <div class="orbitron text-4xl text-white/10 font-black">EST. 2000</div>
                    </div>
                </header>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                    <div class="space-y-6">
                        <div class="group">
                            <label class="text-[10px] uppercase text-cyan-500 font-black mb-2 block tracking-widest">Nation Designation</label>
                            <input type="text" id="custom-name" placeholder="E.G. NEW FEDERATION" class="w-full bg-white/5 border border-white/10 p-4 rounded-xl outline-none focus:border-cyan-400 focus:bg-white/10 transition text-lg">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-[10px] uppercase text-gray-500 font-bold mb-2 block">First Name</label>
                                <input type="text" id="custom-leader-name" placeholder="John" class="w-full bg-white/5 border border-white/10 p-3 rounded-xl outline-none">
                            </div>
                            <div>
                                <label class="text-[10px] uppercase text-gray-500 font-bold mb-2 block">Last Name</label>
                                <input type="text" id="custom-leader-surname" placeholder="Doe" class="w-full bg-white/5 border border-white/10 p-3 rounded-xl outline-none">
                            </div>
                        </div>

                        <div>
                            <label class="text-[10px] uppercase text-gray-500 font-bold mb-2 block">Political Doctrine</label>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="setIdeology('–î–µ–º–æ–∫—Ä–∞—Ç–∏—è', this)" class="ideo-btn p-3 bg-white/5 border border-white/10 rounded-xl text-xs hover:border-cyan-400 transition active-ideo">–î–µ–º–æ–∫—Ä–∞—Ç–∏—è</button>
                                <button onclick="setIdeology('–ê–≤—Ç–æ–∫—Ä–∞—Ç–∏—è', this)" class="ideo-btn p-3 bg-white/5 border border-white/10 rounded-xl text-xs hover:border-red-400 transition">–ê–≤—Ç–æ–∫—Ä–∞—Ç–∏—è</button>
                                <button onclick="setIdeology('–ö–æ–º–º—É–Ω–∏–∑–º', this)" class="ideo-btn p-3 bg-white/5 border border-white/10 rounded-xl text-xs hover:border-red-600 transition">–ö–æ–º–º—É–Ω–∏–∑–º</button>
                                <button onclick="setIdeology('–¢–µ—Ö–Ω–æ–∫—Ä–∞—Ç–∏—è', this)" class="ideo-btn p-3 bg-white/5 border border-white/10 rounded-xl text-xs hover:border-purple-400 transition">–¢–µ—Ö–Ω–æ–∫—Ä–∞—Ç–∏—è</button>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div class="flex gap-6">
                            <div class="flex-1">
                                <label class="text-[10px] uppercase text-gray-500 font-bold mb-2 block text-center">Identity Image</label>
                                <div class="h-44 bg-black/40 rounded-2xl border-2 border-dashed border-white/10 flex items-center justify-center relative overflow-hidden group cursor-pointer">
                                    <input type="file" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="previewFile(this, 'pres-preview')">
                                    <img id="pres-preview" class="w-full h-full object-cover hidden">
                                    <div class="text-center group-hover:text-cyan-400 transition duration-500">
                                        <div class="text-3xl mb-1">üë§</div>
                                        <div class="text-[8px] font-black tracking-widest">UPLOAD BIO-DATA</div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex-1">
                                <label class="text-[10px] uppercase text-gray-500 font-bold mb-2 block text-center">National Ensign</label>
                                <div class="h-44 bg-black/40 rounded-2xl border-2 border-dashed border-white/10 flex items-center justify-center relative overflow-hidden group cursor-pointer">
                                    <input type="file" class="absolute inset-0 opacity-0 cursor-pointer z-10" onchange="previewFile(this, 'flag-preview')">
                                    <img id="flag-preview" class="w-full h-full object-cover hidden">
                                    <div class="text-center group-hover:text-cyan-400 transition duration-500">
                                        <div class="text-3xl mb-1">üö©</div>
                                        <div class="text-[8px] font-black tracking-widest">UPLOAD ENSIGN</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="p-6 bg-cyan-400/5 border border-cyan-400/20 rounded-2xl">
                            <h4 class="text-[10px] orbitron text-cyan-400 mb-2 uppercase">Initial Briefing</h4>
                            <p class="text-[10px] text-gray-400 leading-relaxed">
                                –ó–∞–ø—É—Å–∫ —Å–∏–º—É–ª—è—Ü–∏–∏ —Å 2000 –≥–æ–¥–∞. –í—ã –ø–æ–ª—É—á–∏—Ç–µ –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –Ω–∞–ª–æ–≥–∞–º–∏, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –±—é–¥–∂–µ—Ç–∞ –∏ –≤–æ–µ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏. –í–∞—à–∞ —Ü–µ–ª—å ‚Äî –ø—Ä–∏–≤–µ—Å—Ç–∏ –Ω–∞—Ü–∏—é –∫ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—é –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—É—é —É—Ç–æ–ø–∏—é.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="mt-auto flex items-center justify-between border-t border-white/5 pt-8">
                    <div id="selection-status" class="flex items-center gap-4 opacity-50">
                        <div class="w-3 h-3 bg-gray-500 rounded-full"></div>
                        <span class="text-xs uppercase tracking-widest font-bold">Waiting for selection...</span>
                    </div>
                    <button onclick="confirmStart()" class="btn-cyber px-16 py-5 text-xl tracking-tighter">Initialize Hegemony</button>
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN INTERFACE -->
    <div id="game-ui" class="hidden h-full flex flex-col opacity-0 transition-opacity duration-1000">
        
        <!-- HEADER -->
        <header class="h-24 glass border-b border-cyan-500/20 flex items-center justify-between px-10 z-[100]">
            <div class="flex items-center gap-6">
                <div class="relative group cursor-pointer">
                    <div class="absolute -inset-1 bg-cyan-500 rounded-full blur opacity-25 group-hover:opacity-50 transition"></div>
                    <img id="ui-pres" class="w-16 h-16 rounded-full border-2 border-cyan-500 object-cover bg-black relative">
                    <img id="ui-flag" class="absolute -bottom-1 -right-1 w-10 h-6 rounded border border-black shadow-xl">
                </div>
                <div>
                    <h2 id="ui-country-name" class="orbitron text-2xl font-black text-white tracking-tighter leading-none"></h2>
                    <div class="flex items-center gap-2 mt-1">
                        <span id="ui-ideology-tag" class="text-[8px] bg-cyan-500/20 text-cyan-400 px-2 py-0.5 rounded uppercase font-bold"></span>
                        <p id="ui-leader-name" class="text-[10px] text-gray-400 font-medium uppercase tracking-widest"></p>
                    </div>
                </div>
            </div>

            <div class="flex gap-10">
                <div class="stat-card p-3 rounded-xl min-w-[140px]">
                    <p class="text-[8px] text-gray-500 font-black uppercase mb-1">Treasury Balance</p>
                    <div class="flex items-end gap-2">
                        <span id="ui-money" class="orbitron text-2xl text-green-400 font-bold">$0.00</span>
                        <span id="ui-money-trend" class="text-[10px] text-green-500 mb-1">+0.2%</span>
                    </div>
                </div>
                <div class="stat-card p-3 rounded-xl min-w-[140px]">
                    <p class="text-[8px] text-gray-500 font-black uppercase mb-1">Military Strength</p>
                    <div class="flex items-end gap-2">
                        <span id="ui-army" class="orbitron text-2xl text-red-500 font-bold">0</span>
                        <span class="text-[10px] text-gray-500 mb-1">UNIT</span>
                    </div>
                </div>
                <div class="stat-card p-3 rounded-xl min-w-[140px]">
                    <p class="text-[8px] text-gray-500 font-black uppercase mb-1">Stability Index</p>
                    <div class="w-full h-1.5 bg-gray-800 rounded-full mt-2 overflow-hidden">
                        <div id="ui-stability-bar" class="h-full bg-cyan-400 transition-all duration-1000" style="width: 0%"></div>
                    </div>
                    <p id="ui-stability-text" class="text-[10px] text-cyan-400 font-bold mt-1 text-right">0%</p>
                </div>
            </div>

            <div class="flex items-center gap-6">
                <div class="text-right">
                    <p id="ui-date" class="orbitron text-white text-xl font-black">01 JAN 2000</p>
                    <div class="flex items-center justify-end gap-2 mt-1">
                        <div id="speed-indicator" class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                        <p id="ui-speed-label" class="text-[9px] text-cyan-500 font-bold uppercase tracking-tighter">System: Active (1x)</p>
                    </div>
                </div>
                <div class="flex p-1 bg-white/5 rounded-xl border border-white/5">
                    <button onclick="setSpeed(0)" class="speed-btn w-10 h-10 flex items-center justify-center hover:bg-white/10 rounded-lg transition">‚è∏</button>
                    <button onclick="setSpeed(1)" class="speed-btn w-10 h-10 flex items-center justify-center bg-cyan-500 text-black font-bold rounded-lg transition">1</button>
                    <button onclick="setSpeed(3)" class="speed-btn w-10 h-10 flex items-center justify-center hover:bg-white/10 rounded-lg transition">3</button>
                    <button onclick="setSpeed(10)" class="speed-btn w-10 h-10 flex items-center justify-center hover:bg-white/10 rounded-lg transition">üöÄ</button>
                </div>
            </div>
        </header>

        <main class="flex-grow flex overflow-hidden relative">
            
            <!-- LEFT NAVIGATION -->
            <nav class="w-24 glass border-r border-white/5 flex flex-col py-8 items-center gap-8">
                <button onclick="openTab('main')" class="nav-btn group relative" title="–û–±–∑–æ—Ä">
                    <div class="w-14 h-14 rounded-2xl bg-white/5 flex items-center justify-center text-2xl group-hover:bg-cyan-500 group-hover:text-black transition-all">üåç</div>
                </button>
                <button onclick="openTab('politics')" class="nav-btn group relative" title="–ü–æ–ª–∏—Ç–∏–∫–∞">
                    <div class="w-14 h-14 rounded-2xl bg-white/5 flex items-center justify-center text-2xl group-hover:bg-blue-500 group-hover:text-black transition-all">üèõÔ∏è</div>
                </button>
                <button onclick="openTab('economy')" class="nav-btn group relative" title="–≠–∫–æ–Ω–æ–º–∏–∫–∞">
                    <div class="w-14 h-14 rounded-2xl bg-white/5 flex items-center justify-center text-2xl group-hover:bg-green-500 group-hover:text-black transition-all">üìà</div>
                </button>
                <button onclick="openTab('military')" class="nav-btn group relative" title="–í–æ–π–Ω–∞">
                    <div class="w-14 h-14 rounded-2xl bg-white/5 flex items-center justify-center text-2xl group-hover:bg-red-500 group-hover:text-black transition-all">‚öîÔ∏è</div>
                </button>
                <button onclick="openTab('science')" class="nav-btn group relative" title="–ù–∞—É–∫–∞">
                    <div class="w-14 h-14 rounded-2xl bg-white/5 flex items-center justify-center text-2xl group-hover:bg-purple-500 group-hover:text-black transition-all">üß™</div>
                </button>
                <div class="mt-auto">
                    <button onclick="saveGame()" class="w-12 h-12 flex items-center justify-center opacity-30 hover:opacity-100 transition">üíæ</button>
                </div>
            </nav>

            <!-- DYNAMIC CONTENT AREA -->
            <div class="flex-grow relative bg-[#030407]">
                
                <!-- WORLD MAP / MAIN VIEW -->
                <div id="tab-main" class="game-tab h-full relative">
                    <!-- Virtual Map Background -->
                    <div class="absolute inset-0 opacity-20 pointer-events-none" 
                         style="background-image: 
                            radial-gradient(circle, #00f2ff 1px, transparent 1px),
                            linear-gradient(rgba(0, 242, 255, 0.05) 1px, transparent 1px),
                            linear-gradient(90deg, rgba(0, 242, 255, 0.05) 1px, transparent 1px);
                         background-size: 80px 80px, 40px 40px, 40px 40px;"></div>

                    <!-- News Ticker -->
                    <div id="news-feed" class="absolute bottom-8 left-8 w-[450px] space-y-3 pointer-events-none z-10">
                        <!-- News items -->
                    </div>

                    <!-- Map Overlay Stats -->
                    <div class="absolute top-8 left-8 flex gap-4">
                        <div class="glass p-4 rounded-2xl border-l-4 border-cyan-500">
                            <p class="text-[10px] text-gray-500 font-bold uppercase">–ú–∏—Ä–æ–≤–æ–π –í–í–ü</p>
                            <p id="world-gdp" class="orbitron text-xl font-bold">$0.0T</p>
                        </div>
                        <div class="glass p-4 rounded-2xl border-l-4 border-red-500">
                            <p class="text-[10px] text-gray-500 font-bold uppercase">–ê–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã</p>
                            <p id="world-conflicts" class="orbitron text-xl font-bold">0</p>
                        </div>
                    </div>

                    <div id="map-canvas" class="w-full h-full relative">
                        <!-- Map markers will be generated here -->
                        <div class="flex items-center justify-center h-full flex-col opacity-10">
                            <p class="orbitron text-8xl font-black italic tracking-tighter">STRATEGIC VIEW</p>
                            <p class="tracking-[2em] text-cyan-400">DATA STREAMING ACTIVE</p>
                        </div>
                    </div>
                </div>

                <!-- SUB PAGES (Initially hidden) -->
                <div id="tab-politics" class="game-tab h-full glass hidden p-10 overflow-y-auto scroll-custom">
                    <h2 class="orbitron text-3xl font-black mb-8 border-b border-white/10 pb-4">INTERNAL <span class="text-blue-400">POLITICS</span></h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
                        <div class="space-y-6">
                            <h3 class="text-sm font-bold text-gray-400 uppercase tracking-widest">Active Edicts</h3>
                            <div id="laws-container" class="space-y-4">
                                <!-- Laws generated by JS -->
                            </div>
                        </div>
                        <div class="space-y-6">
                            <h3 class="text-sm font-bold text-gray-400 uppercase tracking-widest">Population Opinion</h3>
                            <div class="glass p-6 rounded-2xl space-y-4">
                                <div class="flex justify-between items-center">
                                    <span class="text-xs">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–∞</span>
                                    <span id="pop-support" class="text-cyan-400 font-bold">85%</span>
                                </div>
                                <div class="w-full h-2 bg-black rounded-full overflow-hidden">
                                    <div id="pop-support-bar" class="h-full bg-cyan-500" style="width: 85%"></div>
                                </div>
                                <div class="grid grid-cols-2 gap-4 pt-4">
                                    <div class="stat-card p-4 rounded-xl">
                                        <p class="text-[9px] text-gray-500 uppercase">–£—Ä–æ–≤–µ–Ω—å –∂–∏–∑–Ω–∏</p>
                                        <p id="life-quality" class="text-lg font-bold">B+</p>
                                    </div>
                                    <div class="stat-card p-4 rounded-xl">
                                        <p class="text-[9px] text-gray-500 uppercase">–ö–æ—Ä—Ä—É–ø—Ü–∏—è</p>
                                        <p id="corruption-level" class="text-lg font-bold text-red-400">12%</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="tab-economy" class="game-tab h-full glass hidden p-10 overflow-y-auto scroll-custom">
                    <h2 class="orbitron text-3xl font-black mb-8 border-b border-white/10 pb-4">GLOBAL <span class="text-green-400">ECONOMY</span></h2>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-2 space-y-8">
                            <div class="grid grid-cols-3 gap-4">
                                <div class="stat-card p-6 rounded-2xl">
                                    <p class="text-xs text-gray-500 font-bold uppercase">–í–í–ü</p>
                                    <p id="eco-gdp" class="orbitron text-2xl font-bold text-white">$0.00</p>
                                </div>
                                <div class="stat-card p-6 rounded-2xl">
                                    <p class="text-xs text-gray-500 font-bold uppercase">–ò–Ω—Ñ–ª—è—Ü–∏—è</p>
                                    <p id="eco-inflation" class="orbitron text-2xl font-bold text-yellow-400">2.1%</p>
                                </div>
                                <div class="stat-card p-6 rounded-2xl">
                                    <p class="text-xs text-gray-500 font-bold uppercase">–ë–µ–∑—Ä–∞–±–æ—Ç–∏—Ü–∞</p>
                                    <p id="eco-unemploy" class="orbitron text-2xl font-bold text-red-400">4.5%</p>
                                </div>
                            </div>
                            <div class="glass p-8 rounded-2xl">
                                <h3 class="text-xs font-black uppercase text-gray-500 mb-6">–ù–∞–ª–æ–≥–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞</h3>
                                <div class="space-y-10">
                                    <div>
                                        <div class="flex justify-between mb-2">
                                            <span class="text-xs">–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å (–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏–∏)</span>
                                            <span id="tax-corp-val" class="text-green-400 font-bold">20%</span>
                                        </div>
                                        <input type="range" min="0" max="80" value="20" oninput="updateTax('corp', this.value)" class="w-full h-1.5 bg-gray-800 rounded-lg appearance-none cursor-pointer accent-green-500">
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-2">
                                            <span class="text-xs">–ù–∞–ª–æ–≥ –Ω–∞ –¥–æ—Ö–æ–¥ (–ì—Ä–∞–∂–¥–∞–Ω–µ)</span>
                                            <span id="tax-pop-val" class="text-green-400 font-bold">15%</span>
                                        </div>
                                        <input type="range" min="0" max="80" value="15" oninput="updateTax('pop', this.value)" class="w-full h-1.5 bg-gray-800 rounded-lg appearance-none cursor-pointer accent-green-500">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-6">
                            <h3 class="text-xs font-black uppercase text-gray-500">–ë—é–¥–∂–µ—Ç–Ω—ã–µ —Å–µ–∫—Ç–æ—Ä–∞</h3>
                            <div id="budget-sliders" class="space-y-6">
                                <!-- Dynamic sliders -->
                            </div>
                        </div>
                    </div>
                </div>

                <div id="tab-military" class="game-tab h-full glass hidden p-10 overflow-y-auto scroll-custom">
                    <h2 class="orbitron text-3xl font-black mb-8 border-b border-white/10 pb-4">WAR <span class="text-red-500">ROOM</span></h2>
                    <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                        <div class="lg:col-span-1 space-y-4">
                            <div class="stat-card p-6 rounded-2xl border-l-4 border-red-500">
                                <p class="text-[10px] text-gray-500 uppercase font-black">–ê—Ä–º–∏—è –≤ —Ä–µ–∑–µ—Ä–≤–µ</p>
                                <p id="mil-total" class="orbitron text-3xl font-bold">0</p>
                            </div>
                            <button onclick="recruitUnits()" class="w-full btn-cyber py-4 rounded-xl text-sm">–ú–æ–±–∏–ª–∏–∑–∞—Ü–∏—è ($50B)</button>
                            <div class="p-4 bg-red-500/5 rounded-xl border border-red-500/20">
                                <h4 class="text-[10px] font-bold text-red-400 uppercase mb-2">–î–æ–∫—Ç—Ä–∏–Ω–∞</h4>
                                <select class="w-full bg-black/40 border-none outline-none text-xs p-2 rounded">
                                    <option>–û–±–æ—Ä–æ–Ω–∏—Ç–µ–ª—å–Ω–∞—è</option>
                                    <option>–ë–ª–∏—Ü–∫—Ä–∏–≥</option>
                                    <option>–Ø–¥–µ—Ä–Ω–æ–µ —Å–¥–µ—Ä–∂–∏–≤–∞–Ω–∏–µ</option>
                                </select>
                            </div>
                        </div>
                        <div class="lg:col-span-3">
                            <div class="glass h-full rounded-2xl p-6">
                                <h3 class="orbitron text-sm text-gray-400 mb-6 uppercase">–†–∞–∑–≤–µ–¥–¥–∞–Ω–Ω—ã–µ –ø–æ —Ü–µ–ª—è–º</h3>
                                <div id="mil-targets" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <!-- Dynamic targets -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="tab-science" class="game-tab h-full glass hidden p-10 overflow-y-auto scroll-custom">
                    <h2 class="orbitron text-3xl font-black mb-8 border-b border-white/10 pb-4">TECHNOLOGY <span class="text-purple-400">TREE</span></h2>
                    <div id="tech-tree" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6">
                        <!-- Tech nodes -->
                    </div>
                </div>
            </div>

            <!-- RIGHT INFO BAR -->
            <aside class="w-96 glass border-l border-white/5 p-8 flex flex-col gap-8 z-20">
                <section>
                    <h3 class="orbitron text-cyan-400 text-xs font-black mb-6 uppercase tracking-[0.2em]">Global Power Ranking</h3>
                    <div id="ranking-list" class="space-y-4">
                        <!-- Rank items -->
                    </div>
                </section>
                
                <section class="mt-auto">
                    <div class="p-6 bg-white/5 rounded-2xl border border-white/5">
                        <h4 class="text-[10px] font-black uppercase text-gray-500 mb-4">Strategic Alerts</h4>
                        <div id="alerts-container" class="space-y-2">
                            <p class="text-[10px] text-cyan-500/50 italic">–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞...</p>
                        </div>
                    </div>
                </section>
            </aside>
        </main>
    </div>

    <!-- EVENT MODAL -->
    <div id="event-modal" class="fixed inset-0 z-[2000] modal-overlay flex items-center justify-center p-6 hidden">
        <div class="max-w-xl w-full glass p-8 rounded-3xl border-t-4 border-cyan-500 shadow-2xl scale-in transform">
            <div class="flex items-center gap-4 mb-6">
                <div class="w-12 h-12 bg-cyan-500 rounded-full flex items-center justify-center text-2xl">üì¢</div>
                <div>
                    <h3 id="event-title" class="orbitron text-xl font-bold text-white">–°–†–û–ß–ù–û–ï –°–û–û–ë–©–ï–ù–ò–ï</h3>
                    <p id="event-date" class="text-[10px] text-gray-500 font-bold uppercase"></p>
                </div>
            </div>
            <p id="event-desc" class="text-sm text-gray-300 leading-relaxed mb-8">
                –ü—Ä–æ–∏–∑–æ—à–ª–æ —Å–æ–±—ã—Ç–∏–µ, —Ç—Ä–µ–±—É—é—â–µ–µ –≤–∞—à–µ–≥–æ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞.
            </p>
            <div id="event-options" class="flex flex-col gap-3">
                <!-- Options -->
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        // CONSTANTS & GAME DATA
        // ==========================================
        const PRESETS = [
            { id: 'USA', name: 'USA', leader: 'Bill Clinton', img: 'https://upload.wikimedia.org/wikipedia/commons/d/d3/Bill_Clinton.jpg', flag: 'https://flagcdn.com/w160/us.png', gdp: 10200, army: 1400, stability: 95, ideology: '–î–µ–º–æ–∫—Ä–∞—Ç–∏—è' },
            { id: 'RUS', name: 'Russia', leader: 'Vladimir Putin', img: 'https://upload.wikimedia.org/wikipedia/commons/c/c2/Vladimir_Putin_2024.jpg', flag: 'https://flagcdn.com/w160/ru.png', gdp: 2600, army: 1200, stability: 70, ideology: '–ê–≤—Ç–æ–∫—Ä–∞—Ç–∏—è' },
            { id: 'CHN', name: 'China', leader: 'Jiang Zemin', img: 'https://upload.wikimedia.org/wikipedia/commons/6/65/Jiang_Zemin_2002.jpg', flag: 'https://flagcdn.com/w160/cn.png', gdp: 1200, army: 2200, stability: 90, ideology: '–ö–æ–º–º—É–Ω–∏–∑–º' },
            { id: 'DEU', name: 'Germany', leader: 'Gerhard Schr√∂der', img: 'https://upload.wikimedia.org/wikipedia/commons/4/4b/Gerhard_Schroeder_2005.jpg', flag: 'https://flagcdn.com/w160/de.png', gdp: 1900, army: 300, stability: 98, ideology: '–î–µ–º–æ–∫—Ä–∞—Ç–∏—è' },
            { id: 'JPN', name: 'Japan', leader: 'Yoshiro Mori', img: 'https://upload.wikimedia.org/wikipedia/commons/e/ee/Yoshiro_Mori_Official.jpg', flag: 'https://flagcdn.com/w160/jp.png', gdp: 4900, army: 240, stability: 99, ideology: '–î–µ–º–æ–∫—Ä–∞—Ç–∏—è' },
            { id: 'IND', name: 'India', leader: 'Atal Vajpayee', img: 'https://upload.wikimedia.org/wikipedia/commons/2/2a/Atal_Bihari_Vajpayee.jpg', flag: 'https://flagcdn.com/w160/in.png', gdp: 460, army: 1300, stability: 75, ideology: '–î–µ–º–æ–∫—Ä–∞—Ç–∏—è' }
        ];

        const TECH_LIST = [
            { id: 'internet_v1', name: 'Broadband', cost: 100, desc: '+10% –∫ —ç–∫–æ–Ω–æ–º–∏–∫–µ', unlocked: false, icon: 'üåê' },
            { id: 'mil_stealth', name: 'Stealth Tech', cost: 250, desc: '+20% –∫ –∞—Ç–∞–∫–µ', unlocked: false, icon: 'üõ©Ô∏è' },
            { id: 'green_energy', name: 'Renewables', cost: 150, desc: '+5 —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏', unlocked: false, icon: 'üçÉ' },
            { id: 'ai_research', name: 'Early AI', cost: 500, desc: '-5% –∫–æ—Ä—Ä—É–ø—Ü–∏–∏', unlocked: false, icon: 'üß†' },
            { id: 'space_stat', name: 'ISS Program', cost: 800, desc: '–ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø—Ä–µ—Å—Ç–∏–∂', unlocked: false, icon: 'üõ∞Ô∏è' },
            { id: 'fusion', name: 'Cold Fusion', cost: 2500, desc: '–ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è', unlocked: false, icon: '‚öõÔ∏è' },
            { id: 'quantum', name: 'Quantum Comp', cost: 1500, desc: '–í–∑–ª–æ–º —Ä—ã–Ω–∫–æ–≤', unlocked: false, icon: 'üíé' },
            { id: 'cyber_war', name: 'Net Warfare', cost: 400, desc: '–ê—Ç–∞–∫–∞ –±–µ–∑ –≤–æ–π–Ω—ã', unlocked: false, icon: 'üëæ' }
        ];

        const LAWS = [
            { id: 'freedom_press', name: '–°–≤–æ–±–æ–¥–∞ –ø—Ä–µ—Å—Å—ã', status: true, impact: { stability: 2, economy: 1, support: 5 } },
            { id: 'curfew', name: '–ö–æ–º–µ–Ω–¥–∞–Ω—Ç—Å–∫–∏–π —á–∞—Å', status: false, impact: { stability: 10, economy: -5, support: -15 } },
            { id: 'propaganda', name: '–ì–æ—Å-–ø—Ä–æ–ø–∞–≥–∞–Ω–¥–∞', status: false, impact: { stability: 5, economy: -2, support: 20 } },
            { id: 'open_borders', name: '–û—Ç–∫—Ä—ã—Ç—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã', status: true, impact: { stability: -5, economy: 10, support: 0 } }
        ];

        // ==========================================
        // GAME STATE
        // ==========================================
        let state = {
            isRunning: false,
            date: new Date(2000, 0, 1),
            speed: 1,
            player: null,
            world: [],
            news: [],
            techUnlocked: [],
            tickCount: 0,
            activeIdeology: '–î–µ–º–æ–∫—Ä–∞—Ç–∏—è',
            taxes: { corp: 20, pop: 15 },
            budget: { military: 20, science: 10, social: 40, infrastructure: 30 },
            activeConflicts: 0
        };

        // ==========================================
        // INITIALIZATION
        // ==========================================
        window.onload = () => {
            initRegistry();
            loadExtraCountries();
            document.body.classList.add('loaded');
        };

        function initRegistry() {
            const list = document.getElementById('country-list');
            list.innerHTML = '';
            PRESETS.forEach(p => {
                const div = document.createElement('div');
                div.className = "flex items-center gap-4 p-4 bg-white/5 rounded-2xl hover:bg-cyan-500/10 cursor-pointer border border-transparent hover:border-cyan-500/30 transition group";
                div.innerHTML = `
                    <div class="w-12 h-12 rounded-xl overflow-hidden border border-white/10 group-hover:border-cyan-500 transition">
                        <img src="${p.flag}" class="w-full h-full object-cover">
                    </div>
                    <div>
                        <h4 class="text-xs font-black text-white group-hover:text-cyan-400 transition">${p.name}</h4>
                        <p class="text-[9px] text-gray-500 font-bold uppercase">${p.leader}</p>
                    </div>
                `;
                div.onclick = () => selectPreset(p);
                list.appendChild(div);
            });
        }

        async function loadExtraCountries() {
            try {
                const res = await fetch('https://restcountries.com/v3.1/all');
                const data = await res.json();
                const filtered = data.filter(c => !PRESETS.find(p => p.id === c.cca3)).slice(0, 70);
                
                filtered.forEach(c => {
                    PRESETS.push({
                        id: c.cca3,
                        name: c.translations.rus?.common || c.name.common,
                        leader: 'National Leader',
                        img: `https://ui-avatars.com/api/?name=${c.cca3}&background=0044ff&color=fff`,
                        flag: c.flags.png,
                        gdp: Math.floor(Math.random() * 800) + 50,
                        army: Math.floor(Math.random() * 150) + 10,
                        stability: 60 + Math.random() * 30,
                        ideology: ['–î–µ–º–æ–∫—Ä–∞—Ç–∏—è', '–ê–≤—Ç–æ–∫—Ä–∞—Ç–∏—è', '–¢–µ—Ö–Ω–æ–∫—Ä–∞—Ç–∏—è'][Math.floor(Math.random()*3)]
                    });
                });
                initRegistry();
            } catch(e) { console.warn("API Unavailable, using core presets."); }
        }

        function selectPreset(p) {
            state.player = { ...p, money: p.gdp / 5, corruption: 10 + Math.random()*20, popSupport: p.stability, gdpGrowth: 0.02 };
            
            const status = document.getElementById('selection-status');
            status.style.opacity = '1';
            status.innerHTML = `<img src="${p.flag}" class="w-6 h-4 object-cover rounded"> <span class="text-xs font-black text-cyan-400 uppercase">${p.name} SELECTED</span>`;
            
            // Auto fill custom fields
            document.getElementById('custom-name').value = p.name;
            const names = p.leader.split(' ');
            document.getElementById('custom-leader-name').value = names[0] || '';
            document.getElementById('custom-leader-surname').value = names[1] || '';
            
            setIdeology(p.ideology, null);
        }

        function setIdeology(ideo, btn) {
            state.activeIdeology = ideo;
            document.querySelectorAll('.ideo-btn').forEach(b => {
                b.classList.remove('bg-cyan-500/20', 'border-cyan-500', 'text-cyan-400');
            });
            if (btn) {
                btn.classList.add('bg-cyan-500/20', 'border-cyan-500', 'text-cyan-400');
            }
        }

        function previewFile(input, target) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = e => {
                    const el = document.getElementById(target);
                    el.src = e.target.result;
                    el.classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        function confirmStart() {
            const name = document.getElementById('custom-name').value;
            if (!name) return alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞—Ü–∏–∏");

            if (!state.player) {
                state.player = {
                    name: name,
                    leader: document.getElementById('custom-leader-name').value + ' ' + document.getElementById('custom-leader-surname').value,
                    img: document.getElementById('pres-preview').src || 'https://ui-avatars.com/api/?name=L',
                    flag: document.getElementById('flag-preview').src || 'https://ui-avatars.com/api/?name=F',
                    gdp: 500,
                    army: 50,
                    stability: 80,
                    money: 100,
                    corruption: 5,
                    popSupport: 80,
                    gdpGrowth: 0.03,
                    ideology: state.activeIdeology
                };
            } else {
                // Merge custom inputs into preset
                state.player.name = name;
                state.player.leader = document.getElementById('custom-leader-name').value + ' ' + document.getElementById('custom-leader-surname').value;
                if (document.getElementById('pres-preview').src) state.player.img = document.getElementById('pres-preview').src;
                if (document.getElementById('flag-preview').src) state.player.flag = document.getElementById('flag-preview').src;
                state.player.ideology = state.activeIdeology;
            }

            // UI Transitions
            document.getElementById('setup-screen').style.transform = "translateY(-100%)";
            setTimeout(() => {
                document.getElementById('setup-screen').classList.add('hidden');
                document.getElementById('game-ui').classList.remove('hidden');
                setTimeout(() => document.getElementById('game-ui').style.opacity = "1", 50);
            }, 800);

            initializeMainUI();
            startGameLoop();
        }

        // ==========================================
        // UI CORE
        // ==========================================
        function initializeMainUI() {
            document.getElementById('ui-country-name').innerText = state.player.name;
            document.getElementById('ui-leader-name').innerText = state.player.leader;
            document.getElementById('ui-pres').src = state.player.img;
            document.getElementById('ui-flag').src = state.player.flag;
            document.getElementById('ui-ideology-tag').innerText = state.player.ideology;
            
            renderLaws();
            renderBudget();
            renderTech();
            renderTargets();
            addNews("–ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –∑–∞–ø—É—â–µ–Ω–∞. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∫–æ–º–∞–Ω–¥–∞–º.");
        }

        function openTab(tabId) {
            document.querySelectorAll('.game-tab').forEach(t => t.classList.add('hidden'));
            document.getElementById('tab-' + tabId).classList.remove('hidden');
            
            // Animation for tab entry
            const tab = document.getElementById('tab-' + tabId);
            tab.style.opacity = "0";
            tab.style.transform = "scale(0.98)";
            setTimeout(() => {
                tab.style.transition = "all 0.5s ease";
                tab.style.opacity = "1";
                tab.style.transform = "scale(1)";
            }, 10);
        }

        function setSpeed(s) {
            state.speed = s;
            document.querySelectorAll('.speed-btn').forEach(b => b.classList.remove('bg-cyan-500', 'text-black'));
            event.currentTarget.classList.add('bg-cyan-500', 'text-black');
            
            const label = document.getElementById('ui-speed-label');
            const ind = document.getElementById('speed-indicator');
            if (s === 0) {
                label.innerText = "System: PAUSED";
                ind.classList.replace('bg-green-500', 'bg-red-500');
            } else {
                label.innerText = `System: ACTIVE (${s}x)`;
                ind.classList.replace('bg-red-500', 'bg-green-500');
            }
        }

        // ==========================================
        // RENDERERS
        // ==========================================
        function renderLaws() {
            const container = document.getElementById('laws-container');
            container.innerHTML = '';
            LAWS.forEach(law => {
                const div = document.createElement('div');
                div.className = "glass p-5 rounded-2xl flex items-center justify-between group hover:border-blue-500/50 transition";
                div.innerHTML = `
                    <div class="flex items-center gap-4">
                        <div class="w-2 h-10 ${law.status ? 'bg-blue-500' : 'bg-gray-700'} rounded-full"></div>
                        <div>
                            <p class="text-xs font-black uppercase text-white">${law.name}</p>
                            <p class="text-[9px] text-gray-500">–≠—Ñ—Ñ–µ–∫—Ç: –°—Ç–∞–±. ${law.impact.stability > 0 ? '+' : ''}${law.impact.stability}%</p>
                        </div>
                    </div>
                    <button onclick="toggleLaw('${law.id}')" class="px-4 py-2 rounded-lg text-[10px] font-black uppercase ${law.status ? 'bg-blue-500/20 text-blue-400' : 'bg-white/5 text-gray-400'}">
                        ${law.status ? '–ê–ö–¢–ò–í–ù–û' : '–í–ö–õ–Æ–ß–ò–¢–¨'}
                    </button>
                `;
                container.appendChild(div);
            });
        }

        function renderBudget() {
            const container = document.getElementById('budget-sliders');
            container.innerHTML = '';
            const sectors = [
                { id: 'military', name: '–û–±–æ—Ä–æ–Ω–∞', color: 'red' },
                { id: 'science', name: '–ù–∞—É–∫–∞', color: 'purple' },
                { id: 'social', name: '–°–æ—Ü. —Å—Ñ–µ—Ä–∞', color: 'blue' },
                { id: 'infrastructure', name: '–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞', color: 'yellow' }
            ];
            
            sectors.forEach(s => {
                const div = document.createElement('div');
                div.innerHTML = `
                    <div class="flex justify-between mb-2">
                        <span class="text-[10px] font-bold uppercase text-gray-400">${s.name}</span>
                        <span class="text-[10px] font-black text-white">${state.budget[s.id]}%</span>
                    </div>
                    <input type="range" min="0" max="100" value="${state.budget[s.id]}" onchange="updateBudget('${s.id}', this.value)" class="w-full h-1 bg-gray-800 rounded-lg appearance-none cursor-pointer accent-${s.color}-500">
                `;
                container.appendChild(div);
            });
        }

        function renderTech() {
            const container = document.getElementById('tech-tree');
            container.innerHTML = '';
            TECH_LIST.forEach(tech => {
                const isUnlocked = state.techUnlocked.includes(tech.id);
                const div = document.createElement('div');
                div.className = `tech-node p-4 rounded-2xl flex flex-col items-center text-center ${isUnlocked ? 'unlocked' : 'available'}`;
                div.innerHTML = `
                    <div class="text-2xl mb-2">${tech.icon}</div>
                    <p class="text-[9px] font-black uppercase">${tech.name}</p>
                    <p class="text-[8px] opacity-50 mt-1">${tech.desc}</p>
                    <button onclick="buyTech('${tech.id}')" class="mt-4 text-[8px] font-bold border border-current px-2 py-1 rounded hover:bg-white/10 ${isUnlocked ? 'hidden' : ''}">
                        RESEARCH ($${tech.cost}B)
                    </button>
                `;
                container.appendChild(div);
            });
        }

        function renderTargets() {
            const container = document.getElementById('mil-targets');
            container.innerHTML = '';
            // Get 4 random countries as targets
            const targets = PRESETS.slice(0, 4);
            targets.forEach(t => {
                const div = document.createElement('div');
                div.className = "p-4 bg-white/5 rounded-xl border border-white/10 flex items-center justify-between";
                div.innerHTML = `
                    <div class="flex items-center gap-3">
                        <img src="${t.flag}" class="w-8 h-5 rounded">
                        <div>
                            <p class="text-[10px] font-bold">${t.name}</p>
                            <p class="text-[8px] text-red-400">MIL: ${t.army}K</p>
                        </div>
                    </div>
                    <button onclick="milAction('${t.id}')" class="bg-red-500/20 text-red-500 text-[8px] font-black px-3 py-1.5 rounded uppercase hover:bg-red-500 hover:text-white transition">Intervene</button>
                `;
                container.appendChild(div);
            });
        }

        // ==========================================
        // GAME LOGIC TICK
        // ==========================================
        function startGameLoop() {
            state.isRunning = true;
            tick();
        }

        function tick() {
            if (state.speed > 0) {
                // Time progression
                const hoursToAdd = state.speed * 2;
                state.date.setHours(state.date.getHours() + hoursToAdd);
                
                // Day Change Logic
                if (state.date.getHours() < hoursToAdd) {
                    processDaily();
                }

                // UI Updates
                updateTimeUI();
            }
            requestAnimationFrame(tick);
        }

        function processDaily() {
            state.tickCount++;
            
            // Economic math
            const taxRevenue = (state.player.gdp * (state.taxes.corp + state.taxes.pop) / 100) / 365;
            const maintenance = (state.player.army * 0.001) + (state.player.gdp * 0.05 / 365);
            
            state.player.money += (taxRevenue - maintenance);
            state.player.gdp += (state.player.gdp * state.player.gdpGrowth / 365);

            // Stability drifts
            if (state.player.popSupport < 30) state.player.stability -= 0.1;
            if (state.player.money < 0) state.player.stability -= 0.5;

            // Random Events
            if (Math.random() < 0.005) triggerRandomEvent();
            if (state.tickCount % 30 === 0) updateWorldRankings();

            updateMainStats();
        }

        function updateMainStats() {
            document.getElementById('ui-money').innerText = `$${state.player.money.toFixed(2)}B`;
            document.getElementById('ui-army').innerText = Math.floor(state.player.army).toLocaleString();
            document.getElementById('ui-stability-bar').style.width = state.player.stability + '%';
            document.getElementById('ui-stability-text').innerText = Math.floor(state.player.stability) + '%';
            
            // GDP Tab
            const ecoGdp = document.getElementById('eco-gdp');
            if (ecoGdp) ecoGdp.innerText = `$${state.player.gdp.toFixed(1)}B`;
            
            // Opinion Tab
            const popSup = document.getElementById('pop-support');
            if (popSup) {
                popSup.innerText = Math.floor(state.player.popSupport) + '%';
                document.getElementById('pop-support-bar').style.width = state.player.popSupport + '%';
            }

            // News Ticker Logic (Clear old news)
            if (state.news.length > 5) {
                const feed = document.getElementById('news-feed');
                if (feed.lastChild) feed.lastChild.remove();
                state.news.pop();
            }
        }

        function updateTimeUI() {
            const options = { day: '2-digit', month: 'short', year: 'numeric' };
            document.getElementById('ui-date').innerText = state.date.toLocaleDateString('en-GB', options).toUpperCase();
        }

        // ==========================================
        // ACTIONS
        // ==========================================
        function updateTax(type, val) {
            state.taxes[type] = parseInt(val);
            document.getElementById(`tax-${type}-val`).innerText = val + '%';
            
            // Impact
            if (val > 40) {
                state.player.popSupport -= 0.05;
                state.player.gdpGrowth -= 0.001;
            } else {
                state.player.gdpGrowth += 0.0005;
            }
        }

        function toggleLaw(id) {
            const law = LAWS.find(l => l.id === id);
            law.status = !law.status;
            
            if (law.status) {
                state.player.stability += law.impact.stability;
                state.player.popSupport += law.impact.support;
            } else {
                state.player.stability -= law.impact.stability;
                state.player.popSupport -= law.impact.support;
            }
            renderLaws();
        }

        function buyTech(id) {
            const tech = TECH_LIST.find(t => t.id === id);
            if (state.player.money >= tech.cost) {
                state.player.money -= tech.cost;
                state.techUnlocked.push(id);
                addNews(`–ò–°–°–õ–ï–î–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û: ${tech.name}`);
                renderTech();
                
                // Apply persistent buffs
                if (id === 'internet_v1') state.player.gdpGrowth += 0.02;
                if (id === 'ai_research') state.player.corruption -= 5;
            } else {
                addNews("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.");
            }
        }

        function recruitUnits() {
            if (state.player.money >= 50) {
                state.player.money -= 50;
                state.player.army += 100;
                addNews("–ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –º–æ–±–∏–ª–∏–∑–∞—Ü–∏—è: +100 –µ–¥. –≤–æ–π—Å–∫.");
                updateMainStats();
            }
        }

        function addNews(text) {
            const feed = document.getElementById('news-feed');
            const el = document.createElement('div');
            el.className = "glass p-4 rounded-xl border-l-4 border-cyan-500 text-[11px] font-bold shadow-2xl animate-in slide-in-from-left duration-500 opacity-0";
            el.innerHTML = `<span class="text-gray-500">[NEWS]</span> ${text}`;
            feed.prepend(el);
            
            setTimeout(() => el.style.opacity = "1", 50);
            state.news.unshift(text);
        }

        // ==========================================
        // EVENT SYSTEM
        // ==========================================
        function triggerRandomEvent() {
            const pool = [
                {
                    title: "–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –ë—É–º",
                    desc: "–í–∞—à–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã–π —Ä–æ—Å—Ç. –ö–∞–∫ –º—ã —ç—Ç–∏–º –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è?",
                    options: [
                        { text: "–°–Ω–∏–∑–∏—Ç—å –Ω–∞–ª–æ–≥–∏ –Ω–∞ 5% (+—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å)", action: () => { state.taxes.corp -= 5; state.player.stability += 10; } },
                        { text: "–ò–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –≥–æ—Å—Ä–µ–∑–µ—Ä–≤ (+$50B)", action: () => { state.player.money += 50; } }
                    ]
                },
                {
                    title: "–ö–∏–±–µ—Ä-–ê—Ç–∞–∫–∞",
                    desc: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –≤–∑–ª–æ–º–∞–ª–∞ –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ —à–ª—é–∑—ã. –•–∞–æ—Å –Ω–∞ —É–ª–∏—Ü–∞—Ö!",
                    options: [
                        { text: "–í–≤–µ—Å—Ç–∏ –ß–° (-10B, +5 —Å—Ç–∞–±)", action: () => { state.player.money -= 10; state.player.stability += 5; } },
                        { text: "–ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å (-15 —Å—Ç–∞–±)", action: () => { state.player.stability -= 15; } }
                    ]
                },
                {
                    title: "–ü—Ä–æ—Ç–µ—Å—Ç—ã",
                    desc: "–ì—Ä–∞–∂–¥–∞–Ω–µ –Ω–µ–¥–æ–≤–æ–ª—å–Ω—ã –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏ –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–∞. –ü–ª–æ—â–∞–¥–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –ª—é–¥—å–º–∏.",
                    options: [
                        { text: "–ü–æ–π—Ç–∏ –Ω–∞ —É—Å—Ç—É–ø–∫–∏ (+—Å—Ç–∞–±, -10B)", action: () => { state.player.stability += 5; state.player.money -= 10; } },
                        { text: "–†–∞–∑–æ–≥–Ω–∞—Ç—å —Å–∏–ª–æ–π (-20 —Å—Ç–∞–±, +–∞—Ä–º–∏—è)", action: () => { state.player.stability -= 20; state.player.army += 5; } }
                    ]
                }
            ];

            const ev = pool[Math.floor(Math.random() * pool.length)];
            showEvent(ev);
        }

        function showEvent(ev) {
            state.speed = 0; // Pause
            const modal = document.getElementById('event-modal');
            modal.classList.remove('hidden');
            
            document.getElementById('event-title').innerText = ev.title;
            document.getElementById('event-desc').innerText = ev.desc;
            document.getElementById('event-date').innerText = state.date.toDateString();
            
            const optContainer = document.getElementById('event-options');
            optContainer.innerHTML = '';
            
            ev.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "w-full p-4 bg-white/5 border border-white/10 rounded-xl text-left hover:bg-cyan-500/20 hover:border-cyan-500 transition text-xs font-bold";
                btn.innerText = opt.text;
                btn.onclick = () => {
                    opt.action();
                    modal.classList.add('hidden');
                    state.speed = 1;
                    updateMainStats();
                };
                optContainer.appendChild(btn);
            });
        }

        function updateWorldRankings() {
            const list = document.getElementById('ranking-list');
            const sorted = [...PRESETS].sort((a, b) => b.gdp - a.gdp).slice(0, 8);
            
            list.innerHTML = '';
            sorted.forEach((c, i) => {
                const isPlayer = c.name === state.player.name;
                const div = document.createElement('div');
                div.className = `flex items-center justify-between p-3 rounded-xl ${isPlayer ? 'bg-cyan-500/10 border border-cyan-500/30' : 'bg-white/5'}`;
                div.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="text-[9px] text-gray-500 font-bold">${i+1}</span>
                        <img src="${c.flag}" class="w-6 h-4 object-cover rounded-sm">
                        <span class="text-[10px] font-black uppercase ${isPlayer ? 'text-cyan-400' : 'text-white'}">${c.name}</span>
                    </div>
                    <span class="orbitron text-[10px] text-green-400 font-bold">$${(c.gdp/1000).toFixed(1)}T</span>
                `;
                list.appendChild(div);
            });
            
            // Stats summary
            const totalGdp = PRESETS.reduce((sum, c) => sum + c.gdp, 0);
            document.getElementById('world-gdp').innerText = `$${(totalGdp/1000).toFixed(1)}T`;
        }

        // ==========================================
        // MAP MARKERS
        // ==========================================
        function generateMapMarkers() {
            const map = document.getElementById('map-canvas');
            for(let i=0; i<30; i++) {
                const marker = document.createElement('div');
                marker.className = 'map-marker';
                marker.style.top = Math.random() * 80 + 10 + '%';
                marker.style.left = Math.random() * 80 + 10 + '%';
                marker.title = "City Hub #" + i;
                map.appendChild(marker);
            }
        }
        generateMapMarkers();

    </script>
</body>
</html>
